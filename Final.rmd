---
title: "Covid91 vaccine study Final2022"
author: "Jake Glickman"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="final_Data.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
```

```{r}
FinalDat <- read.csv(file="final_Data.csv")
```



# Introduction

A new  preventative vaccine (covid91) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

# Males
```{r}
Males <- filter(FinalDat, sex=="M")
```

```{r}
Males <- select(Males, -sex)
```

## Graphic Description
```{r}
dd2 <- Males %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

The bar chart shows the infected rate of males who took the placebo and those who took the covid19 vaccine. About 70% of males who got covid19 took the placebo while only about 30% had the vaccine. For those that were OK it was about 50-50 for the placebo and the vaccine.

## Numerical Results
```{r}
table1 <- xtabs(~infected + treatment, data=Males)
rowPerc(table1)
colPerc(table1)
```

The numerical data tells us that of those that took the placebo 2.63% got covid19. Of those that took the vaccine 1.28% got covid19. These results are indicating that the vaccine is effective.

## Inferential Results
```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The inferential results show that those that took the placebo are a little over twice as likely to catch covid19 as those that took the vaccine. The p-value being very low signifies that there is a small chance of getting these results if there was no difference between the placebo and the vaccine.

# Females
```{r}
Females <- filter(FinalDat, sex=="F")
```

```{r}
Females <- select(Females, -sex)
```

## Graphic Description
```{r}
dd2 <- Females %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

The bar chart shows the rate females who took the placebo or the vaccine got infected. For those that got covid19 about 60% had taken the placebo, while about 40% had taken the vaccine.


## Numerical Results
```{r}
table2 <- xtabs(~infected + treatment, data=Females)
rowPerc(table2)
colPerc(table2)
```

The numerical results show that about 2.3% of those that took the placebo got covid19, while 1.62% of those that took the vaccine got it. The data tells us that the females who took the vaccine got covid19 at a lower rate than those who took the placebo.



## Inferential Results
```{r}
chisq.test(table2)
chisqtestGC(table2)
fishtestf<-fisher.test(table2)
fishtestf
```

The results show about a 1.43 odds ratio. This tells us that those that took the placebo are about 1.43 times as likely to catch covid19 than those that took the vaccine. The results also gave a low p-value which indicates a low chance of getting these results if there was no difference between females who took the placebo or the vaccine.

```{r}
options(digits = 1)
femeffic=fishtestf$estimate/(1+fishtestf$estimate)*100
femefficlo=fishtestf$conf.int[1]/(1+fishtestf$conf.int[1])*100
femeffichi=fishtestf$conf.int[2]/(1+fishtestf$conf.int[2])*100
print(femeffic)
print(femefficlo)
print(femeffichi)
```
The confidence interval of the effectiveness of the vaccine for females has a low of `r femefficlo` and a high of `r femeffichi`.


# LGBTQ



# Druggies



# Conclusion

